<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>DEV-Team</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <div class="logo">BEST<span>RP</span></div>
        <div class="nav-links">
            <a href="index.html">Domů</a>
            <a href="team.html">A-Team</a>
            <a href="devs.html" class="active">DEV-Team</a>
            <a href="apply.html">Whitelist</a>
            <a href="login.html" class="btn-nav" id="nav-btn">Přihlásit</a>
        </div>
    </nav>

    <div class="container">
        <h1>DEVELOPMENT TÝM</h1>
        <p>Ti, co tvoří a opravují server.</p>
        <div class="team-grid" id="team-container">Načítám...</div>
    </div>

    <script>
        const currentUser = JSON.parse(localStorage.getItem('user'));
        const navBtn = document.getElementById('nav-btn');
        if (currentUser) {
            navBtn.innerText = "Můj Účet";
            navBtn.href = "account.html";
            navBtn.style.background = "#ff5555";
        }

        const devConfig = {
            'head dev': { label: 'HEAD DEV', color: '#f1c40f', weight: 60 },
            'developer': { label: 'DEVELOPER', color: '#c27c0e', weight: 50 }
        };

        async function load() {
            const container = document.getElementById('team-container');
            const res = await fetch('/.netlify/functions/get-team');
            const users = await res.json();

            // Filtrujeme: Chceme JEN devy
            const devs = users.filter(u => devConfig[u.role]);

            devs.sort((a, b) => (devConfig[b.role]?.weight || 0) - (devConfig[a.role]?.weight || 0));
            container.innerHTML = '';

            if (devs.length === 0) container.innerHTML = '<p>Žádní vývojáři nenalezeni.</p>';

            devs.forEach(u => {
                const conf = devConfig[u.role];
                container.innerHTML += `
                <div class="card" style="border-color: ${conf.color}">
                    <div class="avatar"><img src="${u.avatar_url}" style="border: 2px solid ${conf.color}"></div>
                    <span class="role" style="color:${conf.color}; border:1px solid ${conf.color}; background:rgba(0,0,0,0.3)">${conf.label}</span>
                    <h3>${u.username}</h3>
                    <p style="font-size:0.8rem; color:#aaa; margin-top:5px;">${u.bio || 'Vývojář'}</p>
                </div>`;
            });
        }
        load();
    </script>
</body>

</html>